
&НаКлиенте
Процедура ОНИМА(Команда)
	ЗапуститьПриложение ("https://10.110.32.138/onyma/main/dogsearch_ok.htms?search=1&menuitem=842&dogcode=" + Объект.НомерДоговора);
КонецПроцедуры

&НаКлиенте
Процедура ЦУП(Команда)
	ЗапуститьПриложение ("https://cup.mit.ru/cgi-bin/index?m_id=104&tabid=2&action=search&search=" + Объект.НомерДоговора);
//ЗапуститьПриложение ("https://cup.mit.ru/cgi-bin/index?m_id=3&string=%" + Объект.Контрагент, "windows-1251");

КонецПроцедуры

&НаКлиенте
Процедура ПланДата(Команда)
	ЗапуститьПриложение ("http://10.10.50.251/index.php?act=plandata&page=view&id=" + Объект.ПланДатаID)
	КонецПроцедуры


&НаКлиенте
Процедура ЦУПedit(Команда)
	ЗапуститьПриложение ("https://cup.mit.ru/cgi-bin/index?m_id=16&uid=" + Объект.ЦУПID);
КонецПроцедуры

&НаКлиенте
Процедура ЕГРЮЛ(Команда)
	ЗапуститьПриложение ("http://online.igk-group.ru/ru/home?name=&ogrn=&inn=" + Объект.ИНН);
	//ЗапуститьПриложение ("https://www.prima-inform.ru/cat/cc/" + Объект.ИНН);

КонецПроцедуры

&НаКлиенте
Процедура УслугиУслугаПриИзменении(Элемент)
// Получить текущую строку табличной части.
СтрокаТабличнойЧасти = Элементы.Услуги.ТекущиеДанные;
// Установить цену.
СтрокаТабличнойЧасти.Цена = РаботаСоСправочниками.РозничнаяЦена(Объект.Дата, СтрокаТабличнойЧасти.Услуга);
СтрокаТабличнойЧасти.Скорость = РаботаСоСправочниками.Скорость(Объект.Дата, СтрокаТабличнойЧасти.Услуга);
СтрокаТабличнойЧасти.Лимит = РаботаСоСправочниками.Лимит(Объект.Дата, СтрокаТабличнойЧасти.Услуга);
СтрокаТабличнойЧасти.СверхЛимита = РаботаСоСправочниками.СверхЛимита(Объект.Дата, СтрокаТабличнойЧасти.Услуга);
СтрокаТабличнойЧасти.Количество = 1.00;
// Пересчитать сумму строки
РаботаСДокументами.РассчитатьСумму(СтрокаТабличнойЧасти);
//Сумма договора
//Если Объект.СтатусДоговора <> "Расторгнут" Тогда
Объект.СуммаДоговора = Объект.Услуги.Итог("Сумма");
//Иначе Объект.СуммаДоговора = 0;
//КонецЕсли;
//Палим менеджера
СтрокаТабличнойЧасти.Менеджер = ИмяПользователя();
//Ставим дату заказа
СтрокаТабличнойЧасти.ДатаЗаказа = ТекущаяДата();

КонецПроцедуры

&НаКлиенте
Процедура УслугиСтатусУслугиПриИзменении(Элемент)
	СтрокаТабличнойЧасти = Элементы.Услуги.ТекущиеДанные;
	СтрокаТабличнойЧасти.ДатаБлокировки = ТекущаяДата();
	РаботаСДокументами.РассчитатьСумму(СтрокаТабличнойЧасти);
	СтрокаТабличнойЧасти.Сумма = 0;
	СтрокаТабличнойЧасти.Количество = 0;
//Если 	Объект.СтатусДоговора <> "Расторгнут" Тогда
	Объект.СуммаДоговора = Объект.Услуги.Итог("Сумма");
//Иначе 	Объект.СуммаДоговора = 0;
//КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура УслугиКоличествоПриИзменении(Элемент)
СтрокаТабличнойЧасти = Элементы.Услуги.ТекущиеДанные;
РаботаСДокументами.РассчитатьСумму(СтрокаТабличнойЧасти);
//Сумма договора
//Если 	Объект.СтатусДоговора <> "Расторгнут" Тогда
	 	Объект.СуммаДоговора = Объект.Услуги.Итог("Сумма");
//Иначе 	Объект.СуммаДоговора = 0;
//КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура УслугиСкидкаПриИзменении(Элемент)
	СтрокаТабличнойЧасти = Элементы.Услуги.ТекущиеДанные;
РаботаСДокументами.РассчитатьСумму(СтрокаТабличнойЧасти);
//Сумма договора
//Если 	Объект.СтатусДоговора <> "Расторгнут" Тогда
	 	Объект.СуммаДоговора = Объект.Услуги.Итог("Сумма");
//Иначе 	Объект.СуммаДоговора = 0;
//КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ДатаРасторженияПриИзменении(Элемент)
Объект.ДатаПогашения = Объект.ДатаРасторжения + 720 * 60 * 60;
Если Объект.ДатаРасторжения <= ТекущаяДата() Тогда
	Объект.СтатусДоговора = "Расторгнут";
	КонецЕсли
КонецПроцедуры

&НаКлиенте
Процедура СрокДействияПриИзменении(Элемент)
	Объект.ДатаРасторжения = Объект.СрокДействия;
	Объект.ДатаПогашения = Объект.СрокДействия + 720 * 60 * 60;
	Объект.Причина = "Срок действия";
Если Объект.СрокДействия <= ТекущаяДата() Тогда
	Объект.СтатусДоговора = "Расторгнут";
	КонецЕсли

КонецПроцедуры


///////////////////////////////////////
//Номер и дата договора

&НаКлиенте
Процедура НомерДоговораПриИзменении(Элемент)
	Объект.Номер = Объект.НомерДоговора;
КонецПроцедуры

&НаКлиенте
Процедура ДатаДоговораПриИзменении(Элемент)
	Объект.Дата = Объект.ДатаДоговора;
КонецПроцедуры

//////////////////////////////////////
&НаКлиенте
Процедура КонтрагентПриИзменении(Элемент)
	
	РеквизитыКонтрагента = ПолучитьРеквизитыКонтрагента(Объект.Контрагент);
	
	Объект.ИНН 	= РеквизитыКонтрагента.ИНН;
	Объект.КПП 	= РеквизитыКонтрагента.КПП;
	Объект.ЮрАдрес = РеквизитыКонтрагента.ЮрАдрес;
	Объект.ПочтАдрес = РеквизитыКонтрагента.ПочтАдрес;
	Объект.КонтактТел = РеквизитыКонтрагента.КонтактТел;
	Объект.ЭлПочта = РеквизитыКонтрагента.ЭлПочта;
	Объект.Банк = РеквизитыКонтрагента.Банк;
	Объект.Казначейство = РеквизитыКонтрагента.Казначейство;
	Объект.РасчСчет = РеквизитыКонтрагента.РасчСчет;
	Объект.ЛицСчет = РеквизитыКонтрагента.ЛицСчет;
	Объект.КорСчет = РеквизитыКонтрагента.КорСчет;
	Объект.БИК = РеквизитыКонтрагента.БИК;
    Объект.ФормаЮЛ = РеквизитыКонтрагента.ФормаЮЛ;
	Объект.КодЕИСУП = РеквизитыКонтрагента.КодЕИСУП;
	Объект.ПаспортДатаВыдачи = РеквизитыКонтрагента.ПаспортДатаВыдачи;
	Объект.ПаспортДатаРождения = РеквизитыКонтрагента.ПаспортДатаРождения;
	Объект.ПаспортМестоРождения = РеквизитыКонтрагента.ПаспортМестоРождения;
	Объект.ПаспортСерияНомер 	= РеквизитыКонтрагента.ПаспортСерияНомер;
	Объект.ПаспортКемВыдан 	= РеквизитыКонтрагента.ПаспортКемВыдан;

	
	
КонецПроцедуры

&НаСервереБезКонтекста
Функция ПолучитьРеквизитыКонтрагента(КонтрагентСсылка) 
    РеквизитыКонтрагента = Новый Структура;
	
	РеквизитыКонтрагента.Вставить("ЮрАдрес"	, КонтрагентСсылка.ЮрАдрес);
	РеквизитыКонтрагента.Вставить("ПочтАдрес"	, КонтрагентСсылка.ПочтАдрес);
	РеквизитыКонтрагента.Вставить("КонтактТел"	, КонтрагентСсылка.КонтактТел);
	РеквизитыКонтрагента.Вставить("ЭлПочта"	, КонтрагентСсылка.ЭлПочта);
    РеквизитыКонтрагента.Вставить("ИНН"		, КонтрагентСсылка.ИНН);
    РеквизитыКонтрагента.Вставить("КПП"		, КонтрагентСсылка.КПП);
	РеквизитыКонтрагента.Вставить("Банк"	, КонтрагентСсылка.Банк);
	РеквизитыКонтрагента.Вставить("Казначейство"	, КонтрагентСсылка.Казначейство);
	РеквизитыКонтрагента.Вставить("РасчСчет"	, КонтрагентСсылка.РасчСчет);
	РеквизитыКонтрагента.Вставить("КорСчет"	, КонтрагентСсылка.КорСчет);
	РеквизитыКонтрагента.Вставить("ЛицСчет"	, КонтрагентСсылка.ЛицСчет);
	РеквизитыКонтрагента.Вставить("БИК"	, КонтрагентСсылка.БИК);
	РеквизитыКонтрагента.Вставить("ФормаЮЛ"	, КонтрагентСсылка.ФормаЮЛ);
	РеквизитыКонтрагента.Вставить("КодЕИСУП"	, КонтрагентСсылка.КодЕИСУП);
    РеквизитыКонтрагента.Вставить("ПаспортСерияНомер"		, КонтрагентСсылка.ПаспортСерияНомер);
    РеквизитыКонтрагента.Вставить("ПаспортКемВыдан"		, КонтрагентСсылка.ПаспортКемВыдан);
	РеквизитыКонтрагента.Вставить("ПаспортДатаВыдачи"	, КонтрагентСсылка.ПаспортДатаВыдачи);
	РеквизитыКонтрагента.Вставить("ПаспортДатаРождения"	, КонтрагентСсылка.ПаспортДатаРождения);
	РеквизитыКонтрагента.Вставить("ПаспортМестоРождения"	, КонтрагентСсылка.ПаспортМестоРождения);
	
	Возврат РеквизитыКонтрагента;    

КонецФункции

&НаСервере
Процедура ПриИзмененииКонтрагентаНаСервере()
	
	// ИНН и КПП в типовых конфигурациях всегда строкового типа
	// ИНН 12 символов, КПП - 9
	
	Объект.ИНН 		= Объект.Контрагент.ИНН;
	Объект.КПП 		= Объект.Контрагент.КПП;
	Объект.ЮрАдрес 	= Объект.Контрагент.ЮрАдрес;
	Объект.ПочтАдрес 	= Объект.Контрагент.ПочтАдрес;
	Объект.КонтактТел 	= Объект.Контрагент.КонтактТел;
	Объект.ЭлПочта 	= Объект.Контрагент.ЭлПочта;
	Объект.Банк 	= Объект.Контрагент.Банк;
	Объект.Казначейство 	= Объект.Контрагент.Казначейство;
	Объект.РасчСчет 	= Объект.Контрагент.РасчСчет;
	Объект.КорСчет 	= Объект.Контрагент.КорСчет;
	Объект.ЛицСчет 	= Объект.Контрагент.ЛицСчет;
	Объект.БИК 	= Объект.Контрагент.БИК;
	Объект.ФормаЮЛ 	= Объект.Контрагент.ФормаЮЛ;
	Объект.КодЕИСУП 	= Объект.Контрагент.КодЕИСУП;
	Объект.ПаспортКемВыдан 	= Объект.Контрагент.ПаспортКемВыдан;
	Объект.ПаспортДатаВыдачи 	= Объект.Контрагент.ПаспортДатаВыдачи;
	Объект.ПаспортДатаРождения 	= Объект.Контрагент.ПаспортДатаРождения;
	Объект.ПаспортМестоРождения 	= Объект.Контрагент.ПаспортМестоРождения;

	
КонецПроцедуры

//////////////////////////////////////
//Печать бланков
//Бланк договора ИНТЕРНЕТ
&НаКлиенте
Процедура Интернет(Команда)
		ИнтернетСервер();
КонецПроцедуры

Процедура ИнтернетСервер()
	
	//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("Интернет");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ДоверТМК =  Константы.ДоверенностьТелекомМК.Получить();
	ДоверТТК = Константы.ДоверенностьТранстелеком.Получить();
	ДоверРТК = Константы.ДоверенностьРостелеком.Получить();

	Попытка 
		
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");
		
		Для Счетчик = 1 По 6 Цикл
// Получить объект, который будем использовать для поиска и замены.
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
  		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ВлицеПодписант]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ВЛице);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НаОсновании]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НаОсновании);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомДоверенности]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомДоверенности);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		
	КонецЦикла;
	
	    Для Счетчик = 1 По 3 Цикл
	  	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.Услуги[ТекСтрока].ДатаЗаказа, "ДЛФ=ДД"));
	   	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь,  "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
	  	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Шапка]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Шапка);

	КонецЦикла;
	
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Скорость]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Скорость);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Банк]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Банк);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Казначейство]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Казначейство);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ИНН]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИНН);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КПП]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КПП);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[БИК]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.БИК);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[РасчСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.РасчСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КорСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КорСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЛицСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЛицСчет);		
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[№Заказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Лимит]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Лимит);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[СверхЛимита]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].СверхЛимита);

	
   
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;

 
КонецПроцедуры

//////////////////////////////////////
//Заказ
&НаКлиенте
Процедура Заказ(Команда)
	ЗаказСервер();
КонецПроцедуры

Процедура ЗаказСервер();

//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("Заказ");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка 
		
	
// Получить объект, который будем использовать для поиска и замены.
	
Для Счетчик = 1 По 2 Цикл
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
	  	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
	   	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь,  "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
	  	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[№Заказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);


КонецЦикла;

		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Лимит]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Лимит);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[СверхЛимита]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].СверхЛимита);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.Услуги[ТекСтрока].ДатаЗаказа, "ДЛФ=ДД"));
 		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Скорость]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Скорость);
		
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;


   	КонецПроцедуры

//////////////////////////////////////
//Бланк договора ТЕЛЕФОНИЯ
&НаКлиенте
Процедура Телефония(Команда)
	ТелефонияСервер();
КонецПроцедуры

Процедура ТелефонияСервер();
	//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("Телефония");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ДоверТМК =  Константы.ДоверенностьТелекомМК.Получить();
	ДоверТТК = Константы.ДоверенностьТранстелеком.Получить();
	ДоверРТК = Константы.ДоверенностьРостелеком.Получить();

	Попытка 
		
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");

		
Для Счетчик = 1 По 8 Цикл		
	
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		
КонецЦикла;
	
Для Счетчик = 1 По 5 Цикл

		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КоличествоНомеров]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Номера]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Номера);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);

		
КонецЦикла;
	
Для Счетчик = 1 По 3 Цикл
		
	  	Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ВлицеПодписант]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ВЛице);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НаОсновании]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НаОсновании);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомДоверенности]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомДоверенности);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказаТел]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Шапка]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Шапка);

КонецЦикла;
	
	  	Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Банк]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Банк);
	  	Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Казначейство]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Казначейство);		
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ИНН]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИНН);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КПП]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КПП);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[БИК]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.БИК);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[РасчСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.РасчСчет);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ЛицСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЛицСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КорСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КорСчет);
		Замена = СсылкаМакет.Content.Find;
	    Замена.Execute("[НомерДоговораМГМН]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговораМГМН);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговораВЗ]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговораВЗ);
		
        //Табличная часть Телефония
			
 		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомерЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДатаЗаказаТел]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.Услуги[ТекСтрока].ДатаЗаказа, "ДЛФ=ДД"));
     	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
  
 	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
 
КонецПроцедуры

//////////////////////////////////////
//Бланк смены тарифа
&НаКлиенте
Процедура СменаТарифа(Команда)
		СменаТарифаСервер();
	КонецПроцедуры

Процедура СменаТарифаСервер();
		
		ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("СменаТарифа");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка 
		
	Для Счетчик = 1 По 3 Цикл
			
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
  		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.Услуги[ТекСтрока].ДатаЗаказа, "ДЛФ=ДД"));
 		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[№Заказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		
	КонецЦикла;	
	
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Лимит]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Лимит);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[СверхЛимита]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].СверхЛимита);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Скорость]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Скорость);
		
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
	
		
		КонецПроцедуры
		
//////////////////////////////////////
//Бланк переноса услуги

&НаКлиенте
Процедура Перенос(Команда)
		ПереносСервер();
	КонецПроцедуры

Процедура ПереносСервер();
		
		ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("Перенос");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка 
		
	Для Счетчик = 1 По 3 Цикл
			
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
  		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.Услуги[ТекСтрока].ДатаЗаказа, "ДЛФ=ДД"));
 		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[№Заказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		
	КонецЦикла;	
	
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Лимит]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Лимит);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[СверхЛимита]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].СверхЛимита);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Скорость]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Скорость);
		
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;

	
		
		КонецПроцедуры

//////////////////////////////////////
//Бланк МГМН
&НаКлиенте
Процедура Межгород(Команда)
		МежгородСервер();
	КонецПроцедуры

Процедура МежгородСервер();
//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("МГМН");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ДоверТМК =  Константы.ДоверенностьТелекомМК.Получить();
	ДоверТТК = Константы.ДоверенностьТранстелеком.Получить();
	ДоверРТК = Константы.ДоверенностьРостелеком.Получить();

	Попытка 
		
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТТК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТТК + "");


Для Счетчик = 1 По 5 Цикл		
	
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговораМГМН]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговораМГМН);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		
КонецЦикла;
	
	
Для Счетчик = 1 По 3 Цикл
	
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КоличествоНомеров]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
	  	Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ВлицеПодписант]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ВЛице);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НаОсновании]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НаОсновании);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомДоверенности]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомДоверенности);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказаТел]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Номера]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Номера);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);

		
КонецЦикла;
	
	  	Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Банк]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Банк);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Казначейство]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Казначейство);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ЛицСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЛицСчет);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ИНН]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИНН);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КПП]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КПП);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[БИК]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.БИК);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[РасчСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.РасчСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КорСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КорСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Шапка]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Шапка);
		
  
 	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;


КонецПроцедуры

//////////////////////////////////////
//Бланк Внутризона
&НаКлиенте
Процедура Внутризона(Команда)
	ВнутризонаСервер();
  КонецПроцедуры

Процедура ВнутризонаСервер();
//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("Внутризона");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ДоверТМК =  Константы.ДоверенностьТелекомМК.Получить();
	ДоверТТК = Константы.ДоверенностьТранстелеком.Получить();
	ДоверРТК = Константы.ДоверенностьРостелеком.Получить();

	Попытка 
		
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверРТК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверРТК + "");


Для Счетчик = 1 По 5 Цикл		
	
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговораВЗ]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговораВЗ);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		
КонецЦикла;
	
	
Для Счетчик = 1 По 3 Цикл
	
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КоличествоНомеров]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
	  	Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ВлицеПодписант]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ВЛице);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НаОсновании]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НаОсновании);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомДоверенности]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомДоверенности);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказаТел]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Номера]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Номера);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);

		
КонецЦикла;
	
	  	Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Банк]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Банк);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ИНН]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИНН);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КПП]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КПП);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[БИК]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.БИК);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[РасчСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.РасчСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КорСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КорСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Казначейство]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Казначейство);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ЛицСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЛицСчет);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Шапка]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Шапка);
		
  
 	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;


КонецПроцедуры	  

//////////////////////////////////////
//Бланк Реальник
&НаКлиенте
Процедура Реальник(Команда)
	РеальникСервер ();
КонецПроцедуры

Процедура РеальникСервер();
	
		ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("Реальник");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка 
		
		// Получить объект, который будем использовать для поиска и замены.
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаДоговора);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаДоговора);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаДоговора);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
	
	    	//Табличная часть Интернет
			
  		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДатаЗаказа);
		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.Услуги[ТекСтрока].ДатаЗаказа, "ДЛФ=ДД"));
 		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[№Заказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь,Объект.Услуги[ТекСтрока].ДатаЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[№Заказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
	 	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Количество]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Количество]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Количество]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Количество]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
 		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
  
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
		
КонецПроцедуры	


//////////////////////////////////////
//Бланк расторжение Услуги связи
&НаКлиенте
Процедура РасторжениеУС(Команда)
	РасторжениеУССервер ();
КонецПроцедуры

Процедура РасторжениеУССервер ();
  
//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("РасторжениеУС");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ДоверТМК =  Константы.ДоверенностьТелекомМК.Получить();

	Попытка 
		
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");
		
// Получить объект, который будем использовать для поиска и замены.

Для Счетчик = 1 По 2 Цикл
	
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаРасторжения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаРасторжения,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаПогашения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаПогашения);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
  		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ВлицеПодписант]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ВЛице);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НаОсновании]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НаОсновании);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Банк]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Банк);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ИНН]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИНН);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КПП]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КПП);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[БИК]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.БИК);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[РасчСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.РасчСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КорСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КорСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказаИнет]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Казначейство]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Казначейство);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ЛицСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЛицСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Шапка]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Шапка);
 
		
	КонецЦикла;
	
		//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
 
КонецПроцедуры

//////////////////////////////////////
//Бланк расторжение телефония
&НаКлиенте
Процедура РасторжениеТел(Команда)
	РасторжениеТелСервер ();
КонецПроцедуры

Процедура РасторжениеТелСервер ();
  
//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("РасторжениеТел");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ДоверТМК =  Константы.ДоверенностьТелекомМК.Получить();

	Попытка

		
	Для Счетчик = 1 По 6 Цикл
			
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаРасторжения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаРасторжения,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаПогашения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаПогашения);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
  		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ВлицеПодписант]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ВЛице);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НаОсновании]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НаОсновании);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Банк]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Банк);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Казначейство]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Казначейство);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ЛицСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЛицСчет);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ИНН]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИНН);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КПП]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КПП);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[БИК]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.БИК);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[РасчСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.РасчСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[КорСчет]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КорСчет);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговораВЗ]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговораВЗ);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговораМГМН]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговораМГМН);
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Шапка]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Шапка);
		
КонецЦикла;		

 		//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
 
КонецПроцедуры

&НаКлиенте
Процедура ПереносТел(Команда)
		ПереносТелСервер();
	КонецПроцедуры

Процедура ПереносТелСервер();
		
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("ПереносТел");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка 
		
		// Получить объект, который будем использовать для поиска и замены.
		Замена = СсылкаМакет.Content.Find;
  		// Заменить заранее определенные ключевые конструкции на требуемый текст.
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаДоговора);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаДоговора);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаДоговора);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		
	
	    	//Табличная часть Интернет
			
  		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаЗаказаТел]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДатаЗаказа);
 		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказаТел]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДатаЗаказа);
 		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомерЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДатаЗаказаТел]", Ложь, Истина, Ложь, , , Истина, , Ложь,Объект.Услуги[ТекСтрока].ДатаЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[НомерЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
	 	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
 		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Номера]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Номера);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КоличествоНомеров]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Номера]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Номера);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КоличествоНомеров]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Номера]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Номера);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КоличествоНомеров]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Номера]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Номера);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КоличествоНомеров]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Номера]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Номера);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КоличествоНомеров]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
   
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
	
		
		КонецПроцедуры

&НаКлиенте
Процедура ЗаказТел(Команда)
			ЗаказТелСервер ();
		КонецПроцедуры
		
Процедура ЗаказТелСервер();
		
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("ЗаказТел");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка 
		
		Для Счетчик = 1 По 3 Цикл
			
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ТипОплаты]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ТипОплаты);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
 		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказаТел]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДатаЗаказа);
 		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомерЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказаТел]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
 		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Номера]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Номера);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КоличествоНомеров]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь,  "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		
	КонецЦикла;	
		
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
	
		
КонецПроцедуры

&НаКлиенте
Процедура ДС(Команда)
			ДССервер ();
		КонецПроцедуры
		
Процедура ДССервер ();
  
//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("ДС");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ДоверТМК =  Константы.ДоверенностьТелекомМК.Получить();

	Попытка
		
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");	
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДЛФ=DD"));
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДЛФ=DD"));
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДЛФ=DD"));
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДЛФ=DD"));
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДЛФ=DD"));
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДЛФ=DD"));
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
  		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ВлицеПодписант]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ВЛице);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НаОсновании]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НаОсновании);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомДоверенности]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомДоверенности);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомДоверенности]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомДоверенности);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
  		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ВлицеПодписант]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ВЛице);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НаОсновании]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НаОсновании);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
  		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ВлицеПодписант]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ВЛице);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НаОсновании]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НаОсновании);

		//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
 
КонецПроцедуры

&НаКлиенте
Процедура НаКарте(Команда)
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ЗапуститьПриложение ("https://yandex.ru/maps/10668/murom/?ll=42.030611%2C55.576436&z=14&mode=search&text=г. Муром, " + "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
КонецПроцедуры

/////////////////////////////////////ФИЗЛИЦА БЛАНКИ/////////////////////////////////////

&НаКлиенте
Процедура ИнтернетФЛ(Команда)
		ИнтернетФЛСервер();
КонецПроцедуры

Процедура ИнтернетФЛСервер()
	
	//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("ИнтернетФЛ2017");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ДоверТМК =  Константы.ДоверенностьТелекомМК.Получить();

	Попытка 
		
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");
		
		Для Счетчик = 1 По 6 Цикл
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");

	КонецЦикла;
	
	Для Счетчик = 1 По 4 Цикл
		
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
		
	КонецЦикла;

	Для Счетчик = 1 По 2 Цикл
			
	    Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь,  "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");


	КонецЦикла;
	
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортСерияНомер]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортСерияНомер);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортКемВыдан]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортКемВыдан);
	    Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортДатаВыдачи]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортДатаВыдачи);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ПаспортДатаРождения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортДатаРождения);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ПаспортМестоРождения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортМестоРождения);
		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.Услуги[ТекСтрока].ДатаЗаказа, "ДЛФ=ДД"));
 		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[№Заказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
	   	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Лимит]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Лимит);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[СверхЛимита]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].СверхЛимита);


	
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
 
КонецПроцедуры

&НаКлиенте
Процедура Приложение2ФЛ(Команда)
	Приложение2ФЛСервер();
КонецПроцедуры

Процедура Приложение2ФЛСервер();
	
	//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("Приложение2ФЛ");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		
		
		//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
	
КонецПроцедуры


&НаКлиенте
Процедура ТелефонияФЛ(Команда)
	ТелефонияФЛСервер();
КонецПроцедуры

Процедура ТелефонияФЛСервер();
	//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("ТелефонияФЛ2017");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ДоверТМК =  Константы.ДоверенностьТелекомМК.Получить();

	Попытка 
		
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");

Для Счетчик = 1 По 6 Цикл
		
		// Получить объект, который будем использовать для поиска и замены.
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДопАдрес);
   		Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
 		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Номера]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Номера);

КонецЦикла;
	
Для Счетчик = 1 По 4 Цикл
	
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);	
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.Услуги[ТекСтрока].ДатаЗаказа, "ДЛФ=ДД"));
 		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[НомерЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
   		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КоличествоНомеров]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
	  	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
		
КонецЦикла;		


Для Счетчик = 1 По 2 Цикл

        Замена.Execute("[Лимит]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Лимит);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[СверхЛимита]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].СверхЛимита);
	  	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ИмяСокр]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ИмяСокр);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПодпДолжность]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПодпДолжность);
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");

		
КонецЦикла;
	
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортСерияНомер]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортСерияНомер);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортКемВыдан]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортКемВыдан);
	    Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортДатаВыдачи]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортДатаВыдачи);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ПаспортДатаРождения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортДатаРождения);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ПаспортМестоРождения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортМестоРождения);
		
 	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
 
КонецПроцедуры

&НаКлиенте
Процедура СменаТарифаФЛ(Команда)
		СменаТарифаФЛСервер();
	КонецПроцедуры

Процедура СменаТарифаФЛСервер();
		
		ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("СменаТарифаФЛ");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка 
		
Для Счетчик = 1 По 6 Цикл
		
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаДоговора);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
  		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДатаЗаказа);
 		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[№Заказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Лимит]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Лимит);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[СверхЛимита]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].СверхЛимита);
		
КонецЦикла;
	
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
	
		
		КонецПроцедуры
		
&НаКлиенте
Процедура ПереносФЛ(Команда)
		ПереносФЛСервер();
	КонецПроцедуры

Процедура ПереносФЛСервер();
		
		ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("ПереносФЛ");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка 
		
		// Получить объект, который будем использовать для поиска и замены.
		Замена = СсылкаМакет.Content.Find;
  		// Заменить заранее определенные ключевые конструкции на требуемый текст.
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортСерияНомер]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортСерияНомер);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортКемВыдан]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортКемВыдан);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортДатаВыдачи]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортДатаВыдачи);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[СегДата]", Ложь, Истина, Ложь, , , Истина, , Ложь, ТекущаяДата());
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);


   
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
	
		
КонецПроцедуры

&НаКлиенте
Процедура РеальникФЛ(Команда)
	РеальникФЛСервер ();
КонецПроцедуры

Процедура РеальникФЛСервер();
	
		ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("РеальникФЛ");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка 
		
		// Получить объект, который будем использовать для поиска и замены.
		Замена = СсылкаМакет.Content.Find;
  		// Заменить заранее определенные ключевые конструкции на требуемый текст.
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаДоговора);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаДоговора);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ДатаДоговора);
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
        Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);

	
	    	//Табличная часть Интернет
			
  		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДатаЗаказа);
		Замена = СсылкаМакет.Content.Find;
 		Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ДатаЗаказа);
 		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[№Заказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[ДатаЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь,Объект.Услуги[ТекСтрока].ДатаЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[№Заказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].НомерЗаказа);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
	 	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Услуга]", Ложь, Истина, Ложь, , , Истина, , Ложь, """" + Объект.Услуги[ТекСтрока].Услуга + """");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
    	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Инстал]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].ИнсталПлатеж);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Количество]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Количество]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Количество]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Количество]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Количество);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Цена]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Цена);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
     	Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Сумма]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Услуги[ТекСтрока].Сумма);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
   
	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
		
КонецПроцедуры	

&НаКлиенте
Процедура РасторжениеФЛ(Команда)
	РасторжениеФЛСервер ();
КонецПроцедуры

Процедура РасторжениеФЛСервер ();
  
//получаем макет из объекта обработки
	ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("РасторжениеФЛ");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;
	ДоверТМК =  Константы.ДоверенностьТелекомМК.Получить();

	Попытка 
		
		Замена = СсылкаМакет.Content.Find;
  		Замена.Execute("[ДоверТМК]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + ДоверТМК + "");		
		
// Получить объект, который будем использовать для поиска и замены.
		Замена = СсылкаМакет.Content.Find;
  		// Заменить заранее определенные ключевые конструкции на требуемый текст.
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаРасторжения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаРасторжения,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаРасторжения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаРасторжения,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Причина]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Причина);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаРасторжения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаРасторжения,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаПогашения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
        Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ДатаДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(Объект.ДатаДоговора,"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
  		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресПочтовый]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПочтАдрес);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ЭлПочта]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЭлПочта);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказаИнет]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[КонтТелефон]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.КонтактТел);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортСерияНомер]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортСерияНомер);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортКемВыдан]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортКемВыдан);
	    Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортДатаВыдачи]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортДатаВыдачи);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ПаспортДатаРождения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортДатаРождения);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ПаспортМестоРождения]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортМестоРождения);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[СегДата]", Ложь, Истина, Ложь, , , Истина, , Ложь, Формат(ТекущаяДата(),"ДФ='''""''дд''""'' ММММ гггг'")+" г.");
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Возврат]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.Возврат);
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[ВозвратПрописью]", Ложь, Истина, Ложь, , , Истина, , Ложь, ЧислоПрописью(Объект.Возврат,"Л=ru_RU; ДП=Ложь","рубль, рубля, рублей, м, копейка, копейки, копеек, ж" ));
		

		//Реквизиты
		
		Замена = СсылкаМакет.Content.Find;
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[АдресЮридический]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ЮрАдрес);

		//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
 
КонецПроцедуры

&НаКлиенте
Процедура БлокировкаФЛ(Команда)
			БлокировкаФЛСервер();
		КонецПроцедуры
		
Процедура БлокировкаФЛСервер ();

		ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
	СсылкаМакет = ОбработкаОбъект.ПолучитьМакет("БлокировкаФЛ");	
	Word = СсылкаМакет.Получить();
	
	//открываем и активируем документ
	СсылкаМакет = Word.Application.Documents(1);
	СсылкаМакет.Activate();    
	
	ТекСтрока = Элементы.Услуги.ТекущаяСтрока;

	Попытка 
		
		// Получить объект, который будем использовать для поиска и замены.
		Замена = СсылкаМакет.Content.Find;
  		// Заменить заранее определенные ключевые конструкции на требуемый текст.
		Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[НомерДоговора]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.НомерДоговора);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ПаспортСерияНомер]", Ложь, Истина, Ложь, , , Истина, , Ложь, Объект.ПаспортСерияНомер);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[Контрагент]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Контрагент + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[АдресЗаказа]", Ложь, Истина, Ложь, , , Истина, , Ложь, "" + Объект.Услуги[ТекСтрока].АдресЗаказа + "");
    	Замена = СсылкаМакет.Content.Find;
    	Замена.Execute("[СегДата]", Ложь, Истина, Ложь, , , Истина, , Ложь, ТекущаяДата());
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);
		Замена = СсылкаМакет.Content.Find;
        Замена.Execute("[ДопАдрес]", Ложь, Истина, Ложь, , , Истина, , Ложь,  Объект.Услуги[ТекСтрока].ДопАдрес);


	 	//включаем видимость приложения
	СсылкаМакет.Application.Visible = Истина;
	
		Исключение
       	// Если произойдет ошибка, выводятся данные об ошибке, и объект закрывается.
		Сообщение = Новый СообщениеПользователю();
		Сообщение.Текст = ОписаниеОшибки();
		Сообщение.Сообщить();
    	
		СсылкаМакет.Application.Quit();
	КонецПопытки;
	
	
КонецПроцедуры

&НаКлиенте
Процедура ПодписатьПриИзменении(Элемент)
	
	РеквизитыПодписанта = ПолучитьРеквизитыПодписанта(Объект.Подписать);
	Объект.ИмяСокр 	= РеквизитыПодписанта.Наименование;
	Объект.Шапка 	= РеквизитыПодписанта.Шапка;
	Объект.ПодпДолжность 	= РеквизитыПодписанта.Должность;
КонецПроцедуры

&НаСервереБезКонтекста
Функция ПолучитьРеквизитыПодписанта(ПодписатьСсылка) 
	
    РеквизитыПодписанта = Новый Структура;

	РеквизитыПодписанта.Вставить("Наименование"	, ПодписатьСсылка.Наименование);
	РеквизитыПодписанта.Вставить("Шапка"	, ПодписатьСсылка.Шапка);
	РеквизитыПодписанта.Вставить("Должность"	, ПодписатьСсылка.Должность);

	Возврат РеквизитыПодписанта;    

КонецФункции

&НаСервере
Процедура ПриИзмененииПодписантаНаСервере()
	
	Объект.ИмяСокр 		= Объект.Подписать.Наименование;
	Объект.Шапка 		= Объект.Подписать.Шапка;
	Объект.ПодпДолжность 		= Объект.Подписать.Должность;

	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если НЕ ЗначениеЗаполнено(Объект.СтатусДоговора) Тогда
	Объект.СтатусДоговора = "Активен";
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Объект.Ссылка) Тогда
	ПараметрДопник = Допники.Параметры.Элементы.Найти("НомерДоговора");
	Если ПараметрДопник <> Неопределено Тогда
		ПараметрДопник.Использование = Истина;
		ПараметрДопник.Значение = Объект.Ссылка.НомерДоговора;
	КонецЕсли;	
КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура СписокДоповВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
		ОткрытьЗначение(Элементы.Допники.ТекущиеДанные.Ссылка);
КонецПроцедуры

